# (중요)DB설계 원칙 - FK는 절대 변하지 않는 값을 쓴다
**Posted on**: 2025-09-03

<p>Group 생성할 때&nbsp;</p>
<p>createdById&nbsp; 라는 컬럼을 넣었다</p>
<p>이 컬럼은 user 테이블의 id(uuid) 를 담고있다. 이 uuid는 user의 email 같은 개념이 아니라, DB에서 식별하는 자동 부여된 변경 불가능한 ID이다.</p>
<p>그룹을 생성할 때, 생성자의 uuid를 여기에 저장해둔다</p>
<p>&nbsp;</p>
<p>CreatedBy 필드는 왜 필요할까?</p>
<p>=&gt; Prisma 모델 코드 안에서만 존재하는 가상 필드이다&nbsp;</p>
<p>DB에 실제 컬럼이 있는 것은 아니고 createdById를 이용해서 User테이블과 자동으로 연결해주는 역할을 수행한다</p>
<p>Prisma 쿼리에서 Include 옵션을 주면, createdById를 따라가서 User 정보 전체를 불러올 수 있다</p>
<p>&nbsp;</p>
<pre class="typescript" id="code_1756865728169"><code>const group = await prisma.group.findFirst({
  include: { createdBy: true }
});
console.log(group.createdBy.email);</code></pre>
<p>&nbsp;</p>
<p>-&gt; 이렇게 하면 id를 가진 user의 이메일, 닉네임, 프로필까지 가져올 수 있다.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&lt;Prisma 스키마&gt;</p>
<pre class="sql" id="code_1756865844058"><code>model Group {
  id           String @id @default(uuid())
  groupName    String

  createdById  String                 // 실제 DB에 저장되는 FK
  createdBy    User @relation(fields: [createdById], references: [id])
}</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&lt;실제 DB 테이블&gt;&nbsp;</p>
<pre class="sql" id="code_1756865875948"><code>CREATE TABLE "Group" (
  id UUID PRIMARY KEY,
  group_name TEXT,
  created_by_id UUID REFERENCES "User"(id)
);</code></pre>
<p>&nbsp;</p>
<p>그럼 왜 이렇게 쓸까?</p>
<p>확장성과 유지보수성이다.</p>
<p>createdbyid 가 아니라, 생성자의 이메일을 그룹 생성자로 바로 저장한다고 하면 될 것 같지만 그렇게 할 경우에는 어떤 문제가 생길까?</p>
<p>만약 user가 이메일을 바꾸게 되면 DB값을 바꿔줘야하는 참사가 일어난다.</p>
<p>이유는 많지만 이것만으로도 충분한 이유가 될 수 있다.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>-----------</p>
<p>그래서, 남은 TO-do 리스트는 ??</p>
<p>스키마 생성. DB 설계</p>
<p>이때 용어 통일</p>
<p>GroupID , loginID 혼용&nbsp;</p>
<p>createdByID , createdBy 정의 필요</p>
<p>createdByID :&nbsp;</p>
<p style="background-color: #212121; color: #ffffff; text-align: left;"><b>내부 식별자(id)와 로그인용 식별자(loginId) 혼용</b></p>
<p>&nbsp;</p>
<p>Flutter &lt;-&gt; Backend 인증/파라미터</p>
<p>UserID는 클라이언트가 보내지 않고 백엔드가 JWT에서 추출</p>
<p style="background-color: #212121; color: #ffffff; text-align: left;"><b>JWT 토큰 누락 시 그룹 생성 실패</b></p>