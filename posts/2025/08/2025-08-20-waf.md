# 알리바가 클라우드 WAF 설정하기 (탐지모드 설정)
**Posted on**: 2025-08-20

<p>&nbsp;</p>
<p>우선 WAF 인스턴스를 별도로 구매해야 한다.</p>
<p>중국 내에서 사용할 것인지, 중국 밖 서비스에서 시용할 것인지를 판단해서 제품을 구매하면 된다.</p>
<p>&nbsp;</p>
<p>내 경우에는 중국 안에서 쓸 것이기 때문에 중국 내부 WAF를 구매하였다.</p>
<p><figure class="imageblock alignCenter"><span><img height="580" src="https://blog.kakaocdn.net/dn/FIgE4/btsPXw2MZTi/OPmvFB8E13dmkqRCbKaBr1/img.png" width="688" /></span></figure>
</p>
<p>AWS는 WAF를 사용할때 구매하고 넘어가지도 않으며, 이렇게 중국 내/외로 대분류 하는 것이 아니라 특정 리전을 선택하게 되어있는데 이 점에서 AWS와 분명한 차이가 존재한다.<br /><br />그럼 WAF는 보통 어디에 붙이나?<br /><br /></p>
<p>권장 아키텍처는 아래와 같다.</p>
<p>[사용자]&nbsp;&rarr;&nbsp;[DNS]&nbsp;&rarr;&nbsp;[WAF]&nbsp;&rarr;&nbsp;[ALB/CLB]&nbsp;&rarr;&nbsp;[ECS&nbsp;Pool] </p>
<p>&nbsp;</p>
<p>DNS에서 트래픽을 WAF로 먼저 보내고, WAF 가 공격 필터링 후 정상 트래픽만 LB로 전달하면 LB가 트래픽을 여러 ECS로 분산한다!<br /><br />현재는 ECS에 직접 붙이는 방법을 설명하겠다. Best Practice는 아니지만, 현재 구성상 LB/DNS가 존재하지 않으며<br />탐지모드로만 돌리면 되기 때문에 WAF를 ECS에 우선 직접 붙여보겠다</p>
<p><br />Website Configuration - Cloud Native 탭에서 Add now를 누른다.</p>
<p>DNS로 할 경우에는 CNAME Record로 할 수 있고, Cloud Native 에서는 LB / ECS 를 설정할 수 있다</p>
<p><figure class="imageblock alignCenter"><span><img height="792" src="https://blog.kakaocdn.net/dn/8L3Fd/btsPW2HEbVK/tROCCsEWZNxbr5x0yzwCgk/img.png" width="2508" /></span></figure>
<figure class="imageblock alignCenter"><span><img height="549" src="https://blog.kakaocdn.net/dn/vcDQs/btsPW3fyK5O/1jdxkcmlw7F9hT856jRYNK/img.png" width="950" /></span></figure>
</p>
<p>Add port 선택 =&gt; HTTP : 80 포트 추가 . HTTPS : 443 포트 추가 및 인증서 정보 업로드!</p>
<p>인증서는 기존에 사용하는 별도 인증서가 있다면 인증서 정보를 업로드하면 되고, 그렇지 않다면 ACM 을 통해서 인증서를 자체 생성하고 붙일 수도 있다.</p>